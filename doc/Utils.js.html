<!DOCTYPE html><html lang="en" style="font-size:16px"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Source: Utils.js</title><!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><script src="scripts/third-party/hljs.js" defer="defer"></script><script src="scripts/third-party/hljs-line-num.js" defer="defer"></script><script src="scripts/third-party/popper.js" defer="defer"></script><script src="scripts/third-party/tippy.js" defer="defer"></script><script src="scripts/third-party/tocbot.min.js"></script><script>var baseURL="/",locationPathname="";baseURL=(locationPathname=document.location.pathname).substr(0,locationPathname.lastIndexOf("/")+1)</script><link rel="stylesheet" href="styles/clean-jsdoc-theme.min.css"><svg aria-hidden="true" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none"><defs><symbol id="copy-icon" viewbox="0 0 488.3 488.3"><g><path d="M314.25,85.4h-227c-21.3,0-38.6,17.3-38.6,38.6v325.7c0,21.3,17.3,38.6,38.6,38.6h227c21.3,0,38.6-17.3,38.6-38.6V124    C352.75,102.7,335.45,85.4,314.25,85.4z M325.75,449.6c0,6.4-5.2,11.6-11.6,11.6h-227c-6.4,0-11.6-5.2-11.6-11.6V124    c0-6.4,5.2-11.6,11.6-11.6h227c6.4,0,11.6,5.2,11.6,11.6V449.6z"/><path d="M401.05,0h-227c-21.3,0-38.6,17.3-38.6,38.6c0,7.5,6,13.5,13.5,13.5s13.5-6,13.5-13.5c0-6.4,5.2-11.6,11.6-11.6h227    c6.4,0,11.6,5.2,11.6,11.6v325.7c0,6.4-5.2,11.6-11.6,11.6c-7.5,0-13.5,6-13.5,13.5s6,13.5,13.5,13.5c21.3,0,38.6-17.3,38.6-38.6    V38.6C439.65,17.3,422.35,0,401.05,0z"/></g></symbol><symbol id="search-icon" viewBox="0 0 512 512"><g><g><path d="M225.474,0C101.151,0,0,101.151,0,225.474c0,124.33,101.151,225.474,225.474,225.474    c124.33,0,225.474-101.144,225.474-225.474C450.948,101.151,349.804,0,225.474,0z M225.474,409.323    c-101.373,0-183.848-82.475-183.848-183.848S124.101,41.626,225.474,41.626s183.848,82.475,183.848,183.848    S326.847,409.323,225.474,409.323z"/></g></g><g><g><path d="M505.902,476.472L386.574,357.144c-8.131-8.131-21.299-8.131-29.43,0c-8.131,8.124-8.131,21.306,0,29.43l119.328,119.328    c4.065,4.065,9.387,6.098,14.715,6.098c5.321,0,10.649-2.033,14.715-6.098C514.033,497.778,514.033,484.596,505.902,476.472z"/></g></g></symbol><symbol id="font-size-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11.246 15H4.754l-2 5H.6L7 4h2l6.4 16h-2.154l-2-5zm-.8-2L8 6.885 5.554 13h4.892zM21 12.535V12h2v8h-2v-.535a4 4 0 1 1 0-6.93zM19 18a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/></symbol><symbol id="add-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M11 11V5h2v6h6v2h-6v6h-2v-6H5v-2z"/></symbol><symbol id="minus-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M5 11h14v2H5z"/></symbol><symbol id="dark-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M10 7a7 7 0 0 0 12 4.9v.1c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2h.1A6.979 6.979 0 0 0 10 7zm-6 5a8 8 0 0 0 15.062 3.762A9 9 0 0 1 8.238 4.938 7.999 7.999 0 0 0 4 12z"/></symbol><symbol id="light-theme-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 18a6 6 0 1 1 0-12 6 6 0 0 1 0 12zm0-2a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM11 1h2v3h-2V1zm0 19h2v3h-2v-3zM3.515 4.929l1.414-1.414L7.05 5.636 5.636 7.05 3.515 4.93zM16.95 18.364l1.414-1.414 2.121 2.121-1.414 1.414-2.121-2.121zm2.121-14.85l1.414 1.415-2.121 2.121-1.414-1.414 2.121-2.121zM5.636 16.95l1.414 1.414-2.121 2.121-1.414-1.414 2.121-2.121zM23 11v2h-3v-2h3zM4 11v2H1v-2h3z"/></symbol><symbol id="reset-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M18.537 19.567A9.961 9.961 0 0 1 12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10c0 2.136-.67 4.116-1.81 5.74L17 12h3a8 8 0 1 0-2.46 5.772l.997 1.795z"/></symbol><symbol id="down-icon" viewBox="0 0 16 16"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.7803 6.21967C13.0732 6.51256 13.0732 6.98744 12.7803 7.28033L8.53033 11.5303C8.23744 11.8232 7.76256 11.8232 7.46967 11.5303L3.21967 7.28033C2.92678 6.98744 2.92678 6.51256 3.21967 6.21967C3.51256 5.92678 3.98744 5.92678 4.28033 6.21967L8 9.93934L11.7197 6.21967C12.0126 5.92678 12.4874 5.92678 12.7803 6.21967Z"></path></symbol><symbol id="codepen-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M16.5 13.202L13 15.535v3.596L19.197 15 16.5 13.202zM14.697 12L12 10.202 9.303 12 12 13.798 14.697 12zM20 10.869L18.303 12 20 13.131V10.87zM19.197 9L13 4.869v3.596l3.5 2.333L19.197 9zM7.5 10.798L11 8.465V4.869L4.803 9 7.5 10.798zM4.803 15L11 19.131v-3.596l-3.5-2.333L4.803 15zM4 13.131L5.697 12 4 10.869v2.262zM2 9a1 1 0 0 1 .445-.832l9-6a1 1 0 0 1 1.11 0l9 6A1 1 0 0 1 22 9v6a1 1 0 0 1-.445.832l-9 6a1 1 0 0 1-1.11 0l-9-6A1 1 0 0 1 2 15V9z"/></symbol><symbol id="close-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"/></symbol><symbol id="menu-icon" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 4h18v2H3V4zm0 7h18v2H3v-2zm0 7h18v2H3v-2z"/></symbol></defs></svg></head><body class="dark" data-theme="dark"><div class="sidebar-container"><div class="sidebar" id="sidebar"><a href="/" class="sidebar-title sidebar-title-anchor">Home</a><div class="sidebar-items-container"><div class="sidebar-section-title with-arrow" data-isopen="false" id="qHlACl8CFdcBMSnoHvrhv"><div>Modules</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="module-AWT.html">AWT</a></div><div class="sidebar-section-children"><a href="module-Activity.html">Activity</a></div><div class="sidebar-section-children"><a href="module-JClic.html">JClic</a></div><div class="sidebar-section-children"><a href="module-JClicPlayer.html">JClicPlayer</a></div><div class="sidebar-section-children"><a href="module-PlayerHistory.html">PlayerHistory</a></div><div class="sidebar-section-children"><a href="module-Utils.html">Utils</a></div><div class="sidebar-section-children"><a href="module-activities_associations_ComplexAssociation.html">activities/associations/ComplexAssociation</a></div><div class="sidebar-section-children"><a href="module-activities_associations_SimpleAssociation.html">activities/associations/SimpleAssociation</a></div><div class="sidebar-section-children"><a href="module-activities_memory_MemoryGame.html">activities/memory/MemoryGame</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Explore.html">activities/panels/Explore</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Identify.html">activities/panels/Identify</a></div><div class="sidebar-section-children"><a href="module-activities_panels_InformationScreen.html">activities/panels/InformationScreen</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Menu.html">activities/panels/Menu</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_DoublePuzzle.html">activities/puzzles/DoublePuzzle</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_ExchangePuzzle.html">activities/puzzles/ExchangePuzzle</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_HolePuzzle.html">activities/puzzles/HolePuzzle</a></div><div class="sidebar-section-children"><a href="module-activities_text_Complete.html">activities/text/Complete</a></div><div class="sidebar-section-children"><a href="module-activities_text_Evaluator.html">activities/text/Evaluator</a></div><div class="sidebar-section-children"><a href="module-activities_text_FillInBlanks.html">activities/text/FillInBlanks</a></div><div class="sidebar-section-children"><a href="module-activities_text_IdentifyText.html">activities/text/IdentifyText</a></div><div class="sidebar-section-children"><a href="module-activities_text_OrderText.html">activities/text/OrderText</a></div><div class="sidebar-section-children"><a href="module-activities_text_TextActivityBase.html">activities/text/TextActivityBase</a></div><div class="sidebar-section-children"><a href="module-activities_text_TextActivityDocument.html">activities/text/TextActivityDocument</a></div><div class="sidebar-section-children"><a href="module-activities_text_WrittenAnswer.html">activities/text/WrittenAnswer</a></div><div class="sidebar-section-children"><a href="module-activities_textGrid_CrossWord.html">activities/textGrid/CrossWord</a></div><div class="sidebar-section-children"><a href="module-activities_textGrid_WordSearch.html">activities/textGrid/WordSearch</a></div><div class="sidebar-section-children"><a href="module-automation_AutoContentProvider.html">automation/AutoContentProvider</a></div><div class="sidebar-section-children"><a href="module-automation_arith_Arith.html">automation/arith/Arith</a></div><div class="sidebar-section-children"><a href="module-bags_ActivitySequence.html">bags/ActivitySequence</a></div><div class="sidebar-section-children"><a href="module-bags_ActivitySequenceElement.html">bags/ActivitySequenceElement</a></div><div class="sidebar-section-children"><a href="module-bags_ActivitySequenceJump.html">bags/ActivitySequenceJump</a></div><div class="sidebar-section-children"><a href="module-bags_ConditionalJumpInfo.html">bags/ConditionalJumpInfo</a></div><div class="sidebar-section-children"><a href="module-bags_JumpInfo.html">bags/JumpInfo</a></div><div class="sidebar-section-children"><a href="module-bags_MediaBag.html">bags/MediaBag</a></div><div class="sidebar-section-children"><a href="module-bags_MediaBagElement.html">bags/MediaBagElement</a></div><div class="sidebar-section-children"><a href="module-boxes_AbstractBox.html">boxes/AbstractBox</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBagContent.html">boxes/ActiveBagContent</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBox.html">boxes/ActiveBox</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxBag.html">boxes/ActiveBoxBag</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxContent.html">boxes/ActiveBoxContent</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxGrid.html">boxes/ActiveBoxGrid</a></div><div class="sidebar-section-children"><a href="module-boxes_BoxBag.html">boxes/BoxBag</a></div><div class="sidebar-section-children"><a href="module-boxes_BoxBase.html">boxes/BoxBase</a></div><div class="sidebar-section-children"><a href="module-boxes_BoxConnector.html">boxes/BoxConnector</a></div><div class="sidebar-section-children"><a href="module-boxes_TextGrid.html">boxes/TextGrid</a></div><div class="sidebar-section-children"><a href="module-boxes_TextGridContent.html">boxes/TextGridContent</a></div><div class="sidebar-section-children"><a href="module-media_ActiveMediaBag.html">media/ActiveMediaBag</a></div><div class="sidebar-section-children"><a href="module-media_ActiveMediaPlayer.html">media/ActiveMediaPlayer</a></div><div class="sidebar-section-children"><a href="module-media_AudioBuffer.html">media/AudioBuffer</a></div><div class="sidebar-section-children"><a href="module-media_EventSounds.html">media/EventSounds</a></div><div class="sidebar-section-children"><a href="module-media_EventSoundsElement.html">media/EventSoundsElement</a></div><div class="sidebar-section-children"><a href="module-media_MediaContent.html">media/MediaContent</a></div><div class="sidebar-section-children"><a href="module-media_MidiAudioPlayer.html">media/MidiAudioPlayer</a></div><div class="sidebar-section-children"><a href="module-project_JClicProject.html">project/JClicProject</a></div><div class="sidebar-section-children"><a href="module-project_ProjectSettings.html">project/ProjectSettings</a></div><div class="sidebar-section-children"><a href="module-report_ActionReg.html">report/ActionReg</a></div><div class="sidebar-section-children"><a href="module-report_ActivityReg.html">report/ActivityReg</a></div><div class="sidebar-section-children"><a href="module-report_EncryptMin.html">report/EncryptMin</a></div><div class="sidebar-section-children"><a href="module-report_Reporter.html">report/Reporter</a></div><div class="sidebar-section-children"><a href="module-report_SCORM.html">report/SCORM</a></div><div class="sidebar-section-children"><a href="module-report_SequenceReg.html">report/SequenceReg</a></div><div class="sidebar-section-children"><a href="module-report_SessionReg.html">report/SessionReg</a></div><div class="sidebar-section-children"><a href="module-report_SessionStorageReporter.html">report/SessionStorageReporter</a></div><div class="sidebar-section-children"><a href="module-report_TCPReporter.html">report/TCPReporter</a></div><div class="sidebar-section-children"><a href="module-shapers_ClassicJigSaw.html">shapers/ClassicJigSaw</a></div><div class="sidebar-section-children"><a href="module-shapers_Holes.html">shapers/Holes</a></div><div class="sidebar-section-children"><a href="module-shapers_JigSaw.html">shapers/JigSaw</a></div><div class="sidebar-section-children"><a href="module-shapers_Rectangular.html">shapers/Rectangular</a></div><div class="sidebar-section-children"><a href="module-shapers_Shaper.html">shapers/Shaper</a></div><div class="sidebar-section-children"><a href="module-shapers_TriangularJigSaw.html">shapers/TriangularJigSaw</a></div><div class="sidebar-section-children"><a href="module-skins_BlueSkin.html">skins/BlueSkin</a></div><div class="sidebar-section-children"><a href="module-skins_Counter.html">skins/Counter</a></div><div class="sidebar-section-children"><a href="module-skins_CustomSkin.html">skins/CustomSkin</a></div><div class="sidebar-section-children"><a href="module-skins_DefaultSkin.html">skins/DefaultSkin</a></div><div class="sidebar-section-children"><a href="module-skins_EmptySkin.html">skins/EmptySkin</a></div><div class="sidebar-section-children"><a href="module-skins_GreenSkin.html">skins/GreenSkin</a></div><div class="sidebar-section-children"><a href="module-skins_MiniSkin.html">skins/MiniSkin</a></div><div class="sidebar-section-children"><a href="module-skins_OrangeSkin.html">skins/OrangeSkin</a></div><div class="sidebar-section-children"><a href="module-skins_SimpleSkin.html">skins/SimpleSkin</a></div><div class="sidebar-section-children"><a href="module-skins_Skin.html">skins/Skin</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="xnPDc3I_kKVhPtm1lO4E8"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="module-AWT.Action.html">Action</a></div><div class="sidebar-section-children"><a href="module-AWT.Container.html">Container</a></div><div class="sidebar-section-children"><a href="module-AWT.Dimension.html">Dimension</a></div><div class="sidebar-section-children"><a href="module-AWT.Ellipse.html">Ellipse</a></div><div class="sidebar-section-children"><a href="module-AWT.Font.html">Font</a></div><div class="sidebar-section-children"><a href="module-AWT.Gradient.html">Gradient</a></div><div class="sidebar-section-children"><a href="module-AWT.Path.html">Path</a></div><div class="sidebar-section-children"><a href="module-AWT.PathStroke.html">PathStroke</a></div><div class="sidebar-section-children"><a href="module-AWT.Point.html">Point</a></div><div class="sidebar-section-children"><a href="module-AWT.Rectangle.html">Rectangle</a></div><div class="sidebar-section-children"><a href="module-AWT.Shape.html">Shape</a></div><div class="sidebar-section-children"><a href="module-AWT.Stroke.html">Stroke</a></div><div class="sidebar-section-children"><a href="module-AWT.Timer.html">Timer</a></div><div class="sidebar-section-children"><a href="module-Activity.Activity.html">Activity</a></div><div class="sidebar-section-children"><a href="module-Activity.ActivityPanel.html">ActivityPanel</a></div><div class="sidebar-section-children"><a href="module-JClicPlayer.JClicPlayer.html">JClicPlayer</a></div><div class="sidebar-section-children"><a href="module-PlayerHistory.PlayerHistory.html">PlayerHistory</a></div><div class="sidebar-section-children"><a href="module-activities_associations_ComplexAssociation.ComplexAssociation.html">ComplexAssociation</a></div><div class="sidebar-section-children"><a href="module-activities_associations_ComplexAssociation.ComplexAssociationPanel.html">ComplexAssociationPanel</a></div><div class="sidebar-section-children"><a href="module-activities_associations_SimpleAssociation.SimpleAssociation.html">SimpleAssociation</a></div><div class="sidebar-section-children"><a href="module-activities_associations_SimpleAssociation.SimpleAssociationPanel.html">SimpleAssociationPanel</a></div><div class="sidebar-section-children"><a href="module-activities_memory_MemoryGame.MemoryGame.html">MemoryGame</a></div><div class="sidebar-section-children"><a href="module-activities_memory_MemoryGame.MemoryGamePanel.html">MemoryGamePanel</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Explore.Explore.html">Explore</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Explore.ExplorePanel.html">ExplorePanel</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Identify.Identify.html">Identify</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Identify.IdentifyPanel.html">IdentifyPanel</a></div><div class="sidebar-section-children"><a href="module-activities_panels_InformationScreen.InformationScreen.html">InformationScreen</a></div><div class="sidebar-section-children"><a href="module-activities_panels_InformationScreen.InformationScreenPanel.html">InformationScreenPanel</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Menu.Menu.html">Menu</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Menu.MenuPanel.html">MenuPanel</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_DoublePuzzle.DoublePuzzle.html">DoublePuzzle</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_DoublePuzzle.DoublePuzzlePanel.html">DoublePuzzlePanel</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_ExchangePuzzle.ExchangePuzzle.html">ExchangePuzzle</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_ExchangePuzzle-ExchangePuzzlePanel.html">ExchangePuzzlePanel</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_HolePuzzle.HolePuzzle.html">HolePuzzle</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_HolePuzzle.HolePuzzlePanel.html">HolePuzzlePanel</a></div><div class="sidebar-section-children"><a href="module-activities_text_Complete.Complete.html">Complete</a></div><div class="sidebar-section-children"><a href="module-activities_text_Complete.CompletePanel.html">CompletePanel</a></div><div class="sidebar-section-children"><a href="module-activities_text_Evaluator.BasicEvaluator.html">BasicEvaluator</a></div><div class="sidebar-section-children"><a href="module-activities_text_Evaluator.ComplexEvaluator.html">ComplexEvaluator</a></div><div class="sidebar-section-children"><a href="module-activities_text_Evaluator.Evaluator.html">Evaluator</a></div><div class="sidebar-section-children"><a href="module-activities_text_FillInBlanks.FillInBlanks.html">FillInBlanks</a></div><div class="sidebar-section-children"><a href="module-activities_text_FillInBlanks.FillInBlanksPanel.html">FillInBlanksPanel</a></div><div class="sidebar-section-children"><a href="module-activities_text_IdentifyText.IdentifyText.html">IdentifyText</a></div><div class="sidebar-section-children"><a href="module-activities_text_IdentifyText-IdentifyTextPanel.html">IdentifyTextPanel</a></div><div class="sidebar-section-children"><a href="module-activities_text_OrderText.OrderText.html">OrderText</a></div><div class="sidebar-section-children"><a href="module-activities_text_OrderText.OrderTextPanel.html">OrderTextPanel</a></div><div class="sidebar-section-children"><a href="module-activities_text_TextActivityBase.TextActivityBase.html">TextActivityBase</a></div><div class="sidebar-section-children"><a href="module-activities_text_TextActivityBase.TextActivityBasePanel.html">TextActivityBasePanel</a></div><div class="sidebar-section-children"><a href="module-activities_text_TextActivityDocument.TextActivityDocument.html">TextActivityDocument</a></div><div class="sidebar-section-children"><a href="module-activities_text_TextActivityDocument.TextTarget.html">TextTarget</a></div><div class="sidebar-section-children"><a href="module-activities_text_WrittenAnswer.WrittenAnswer.html">WrittenAnswer</a></div><div class="sidebar-section-children"><a href="module-activities_text_WrittenAnswer.WrittenAnswerPanel.html">WrittenAnswerPanel</a></div><div class="sidebar-section-children"><a href="module-activities_textGrid_CrossWord.CrossWord.html">CrossWord</a></div><div class="sidebar-section-children"><a href="module-activities_textGrid_CrossWord.CrossWordPanel.html">CrossWordPanel</a></div><div class="sidebar-section-children"><a href="module-activities_textGrid_WordSearch.WordSearch.html">WordSearch</a></div><div class="sidebar-section-children"><a href="module-activities_textGrid_WordSearch.WordSearchPanel.html">WordSearchPanel</a></div><div class="sidebar-section-children"><a href="module-automation_AutoContentProvider.AutoContentProvider.html">AutoContentProvider</a></div><div class="sidebar-section-children"><a href="module-automation_AutoContentProvider.AutoContentProvider.ActiveBagContentKit.html">ActiveBagContentKit</a></div><div class="sidebar-section-children"><a href="module-automation_arith_Arith.Arith.html">Arith</a></div><div class="sidebar-section-children"><a href="module-automation_arith_Arith.Arith.Operator.html">Operator</a></div><div class="sidebar-section-children"><a href="module-bags_ActivitySequence.ActivitySequence.html">ActivitySequence</a></div><div class="sidebar-section-children"><a href="module-bags_ActivitySequenceElement.ActivitySequenceElement.html">ActivitySequenceElement</a></div><div class="sidebar-section-children"><a href="module-bags_ActivitySequenceJump.ActivitySequenceJump.html">ActivitySequenceJump</a></div><div class="sidebar-section-children"><a href="module-bags_ConditionalJumpInfo.ConditionalJumpInfo.html">ConditionalJumpInfo</a></div><div class="sidebar-section-children"><a href="module-bags_JumpInfo.JumpInfo.html">JumpInfo</a></div><div class="sidebar-section-children"><a href="module-bags_MediaBag.MediaBag.html">MediaBag</a></div><div class="sidebar-section-children"><a href="module-bags_MediaBagElement.MediaBagElement.html">MediaBagElement</a></div><div class="sidebar-section-children"><a href="module-boxes_AbstractBox.AbstractBox.html">AbstractBox</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBagContent.ActiveBagContent.html">ActiveBagContent</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBox.ActiveBox.html">ActiveBox</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxBag.ActiveBoxBag.html">ActiveBoxBag</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxContent.ActiveBoxContent.html">ActiveBoxContent</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxContent.AlignType.html">AlignType</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxGrid.ActiveBoxGrid.html">ActiveBoxGrid</a></div><div class="sidebar-section-children"><a href="module-boxes_BoxBag.BoxBag.html">BoxBag</a></div><div class="sidebar-section-children"><a href="module-boxes_BoxBase.BoxBase.html">BoxBase</a></div><div class="sidebar-section-children"><a href="module-boxes_BoxConnector.BoxConnector.html">BoxConnector</a></div><div class="sidebar-section-children"><a href="module-boxes_TextGrid.TextGrid.html">TextGrid</a></div><div class="sidebar-section-children"><a href="module-boxes_TextGridContent.TextGridContent.html">TextGridContent</a></div><div class="sidebar-section-children"><a href="module-media_ActiveMediaBag.ActiveMediaBag.html">ActiveMediaBag</a></div><div class="sidebar-section-children"><a href="module-media_ActiveMediaPlayer.ActiveMediaPlayer.html">ActiveMediaPlayer</a></div><div class="sidebar-section-children"><a href="module-media_AudioBuffer.AudioBuffer.html">AudioBuffer</a></div><div class="sidebar-section-children"><a href="module-media_EventSounds.EventSounds.html">EventSounds</a></div><div class="sidebar-section-children"><a href="module-media_EventSoundsElement.EventSoundsElement.html">EventSoundsElement</a></div><div class="sidebar-section-children"><a href="module-media_MediaContent.MediaContent.html">MediaContent</a></div><div class="sidebar-section-children"><a href="module-media_MidiAudioPlayer.MidiAudioPlayer.html">MidiAudioPlayer</a></div><div class="sidebar-section-children"><a href="module-project_JClicProject.JClicProject.html">JClicProject</a></div><div class="sidebar-section-children"><a href="module-project_ProjectSettings.ProjectSettings.html">ProjectSettings</a></div><div class="sidebar-section-children"><a href="module-report_ActionReg.ActionReg.html">ActionReg</a></div><div class="sidebar-section-children"><a href="module-report_ActivityReg.ActivityReg.html">ActivityReg</a></div><div class="sidebar-section-children"><a href="module-report_EncryptMin.Encryption.html">Encryption</a></div><div class="sidebar-section-children"><a href="module-report_Reporter.Reporter.html">Reporter</a></div><div class="sidebar-section-children"><a href="module-report_Reporter.ReporterInfo.html">ReporterInfo</a></div><div class="sidebar-section-children"><a href="module-report_SCORM.SCORM.html">SCORM</a></div><div class="sidebar-section-children"><a href="module-report_SequenceReg.SequenceReg.html">SequenceReg</a></div><div class="sidebar-section-children"><a href="module-report_SequenceReg.SequenceRegInfo.html">SequenceRegInfo</a></div><div class="sidebar-section-children"><a href="module-report_SessionReg.SessionReg.html">SessionReg</a></div><div class="sidebar-section-children"><a href="module-report_SessionReg.SessionRegInfo.html">SessionRegInfo</a></div><div class="sidebar-section-children"><a href="module-report_SessionStorageReporter.SessionStorageReporter.html">SessionStorageReporter</a></div><div class="sidebar-section-children"><a href="module-report_TCPReporter.ReportBean.html">ReportBean</a></div><div class="sidebar-section-children"><a href="module-report_TCPReporter.TCPReporter.html">TCPReporter</a></div><div class="sidebar-section-children"><a href="module-shapers_ClassicJigSaw.ClassicJigSaw.html">ClassicJigSaw</a></div><div class="sidebar-section-children"><a href="module-shapers_Holes.Holes.html">Holes</a></div><div class="sidebar-section-children"><a href="module-shapers_JigSaw.JigSaw.html">JigSaw</a></div><div class="sidebar-section-children"><a href="module-shapers_Rectangular.Rectangular.html">Rectangular</a></div><div class="sidebar-section-children"><a href="module-shapers_Shaper.Shaper.html">Shaper</a></div><div class="sidebar-section-children"><a href="module-shapers_TriangularJigSaw.TriangularJigSaw.html">TriangularJigSaw</a></div><div class="sidebar-section-children"><a href="module-skins_BlueSkin.BlueSkin.html">BlueSkin</a></div><div class="sidebar-section-children"><a href="module-skins_Counter.Counter.html">Counter</a></div><div class="sidebar-section-children"><a href="module-skins_CustomSkin.CustomSkin.html">CustomSkin</a></div><div class="sidebar-section-children"><a href="module-skins_DefaultSkin.DefaultSkin.html">DefaultSkin</a></div><div class="sidebar-section-children"><a href="module-skins_EmptySkin.EmptySkin.html">EmptySkin</a></div><div class="sidebar-section-children"><a href="module-skins_GreenSkin.GreenSkin.html">GreenSkin</a></div><div class="sidebar-section-children"><a href="module-skins_MiniSkin.MiniSkin.html">MiniSkin</a></div><div class="sidebar-section-children"><a href="module-skins_OrangeSkin.OrangeSkin.html">OrangeSkin</a></div><div class="sidebar-section-children"><a href="module-skins_SimpleSkin.SimpleSkin.html">SimpleSkin</a></div><div class="sidebar-section-children"><a href="module-skins_Skin.Skin.html">Skin</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="xJuSofp4IKU_YxKjABy4G"><div>Externals</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="external-AudioContext.html">AudioContext</a></div><div class="sidebar-section-children"><a href="external-CanvasRenderingContext2D.html">CanvasRenderingContext2D</a></div><div class="sidebar-section-children"><a href="external-Collator.html">Collator</a></div><div class="sidebar-section-children"><a href="external-Date.html">Date</a></div><div class="sidebar-section-children"><a href="external-Event.html">Event</a></div><div class="sidebar-section-children"><a href="external-HTMLAudioElement.html">HTMLAudioElement</a></div><div class="sidebar-section-children"><a href="external-HTMLElement.html">HTMLElement</a></div><div class="sidebar-section-children"><a href="external-HTMLImageElement.html">HTMLImageElement</a></div><div class="sidebar-section-children"><a href="external-HTMLStyleElement.html">HTMLStyleElement</a></div><div class="sidebar-section-children"><a href="external-Instrument.html">Instrument</a></div><div class="sidebar-section-children"><a href="external-JSZip.html">JSZip</a></div><div class="sidebar-section-children"><a href="external-MediaRecorder.html">MediaRecorder</a></div><div class="sidebar-section-children"><a href="external-MidiPlayerJS.html">MidiPlayerJS</a></div><div class="sidebar-section-children"><a href="external-NamedNodeMap.html">NamedNodeMap</a></div><div class="sidebar-section-children"><a href="external-Promise.html">Promise</a></div><div class="sidebar-section-children"><a href="external-Storage.html">Storage</a></div><div class="sidebar-section-children"><a href="external-jQuery.html">jQuery</a></div><div class="sidebar-section-children"><a href="external-jqXHR.html">jqXHR</a></div></div></div></div></div><div class="navbar-container" id="VuAckcnZhf"><nav class="navbar"><div class="navbar-left-items"></div><div class="navbar-right-items"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div><nav></nav></nav></div><div class="toc-container"><div class="toc-content"><span class="bold">On this page</span><div id="eed4d2a0bfd64539bb9df78095dec881"></div></div></div><div class="body-wrapper"><div class="main-content"><div class="main-wrapper"><section id="source-page" class="source-page"><header><h1 id="title" class="has-anchor">Utils.js</h1></header><article><pre class="prettyprint source lang-js"><code>/**
 *  File    : Utils.js
 *  Created : 01/04/2015
 *  By      : Francesc Busquets &lt;francesc@gmail.com>
 *
 *  JClic.js
 *  An HTML5 player of JClic activities
 *  https://projectestac.github.io/jclic.js
 *
 *  @source https://github.com/projectestac/jclic.js
 *
 *  @license EUPL-1.2
 *  @licstart
 *  (c) 2000-2020 Educational Telematic Network of Catalonia (XTEC)
 *
 *  Licensed under the EUPL, Version 1.1 or -as soon they will be approved by
 *  the European Commission- subsequent versions of the EUPL (the "Licence");
 *  You may not use this work except in compliance with the Licence.
 *
 *  You may obtain a copy of the Licence at:
 *  https://joinup.ec.europa.eu/software/page/eupl
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the Licence is distributed on an "AS IS" basis, WITHOUT
 *  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 *  Licence for the specific language governing permissions and limitations
 *  under the Licence.
 *  @licend
 *  @module
 */

/* global Promise, window, document, console, HTMLElement */

import $ from 'jquery';
import * as clipboard from 'clipboard-polyfill';
import JSZip from 'jszip';
import JSZipUtils from 'jszip-utils';
import WebFont from 'webfontloader';
import GlobalData from './GlobalData';

/**
 * Exports third-party NPM packages used by JClic, so they become available to other scripts through
 * the global variable `JClicObject` (defined in {@link module:JClic.JClic})
 * @example &lt;caption>Example usage of JSZip through JClicObject&lt;/caption>
 * var WebFont = window.JClicObject.Utils.pkg.WebFont;
 * WebFont.load({google: {families: ['Roboto']}});
 * @type: {object}
 */
export const pkg = {
  clipboard,
  $,
  JSZip,
  JSZipUtils,
  WebFont,
};

/**
 * List of valid verbosity levels
 * @const {string[]}
 */
export const LOG_LEVELS = ['none', 'error', 'warn', 'info', 'debug', 'trace', 'all'];

/**
 * Labels printed on logs for each message type
 * @const {string[]}
 */
export const LOG_PRINT_LABELS = ['     ', 'ERROR', 'WARN ', 'INFO ', 'DEBUG', 'TRACE', 'ALL  '];

/**
 * Options of the logging system
 * @type {object} */
export const LOG_OPTIONS = {
  level: 2, // warn
  prefix: 'JClic',
  timestamp: true,
  popupOnErrors: false,
  chainTo: null,
  pipeTo: null,
};

/**
 * Current dictionary of string translations
 */
let _messages = {};

/**
 * Initializes the global settings
 * @param {object} options - An object with global settings
 * @param {boolean} [setLog=true] - When `true`, the log level will be set
 * @param {boolean} [setLang=true] - When `true`, the current language will be set
 * @returns {object} The normalized `options` object
 */
export function init(options, setLog = true, setLang = true) {
  options = normalizeObject(options);
  if (setLog) {
    if (typeof options.logLevel !== 'undefined')
      setLogLevel(options.logLevel);
    if (typeof options.chainLogTo === 'function')
      LOG_OPTIONS.chainTo = options.chainLogTo;
    if (typeof options.pipeLogTo === 'function')
      LOG_OPTIONS.pipeTo = options.pipeLogTo;
  }

  if (setLang) {
    const lngRequested = options.lang;
    const lng = checkPreferredLanguage(GlobalData.languages, 'en', lngRequested);
    log('debug', `Language ${lngRequested ? `requested: "${lngRequested}" ` : ''} used: "${lng}"`);
    _messages = lng === 'en' ? {} : GlobalData.messages[lng];
  }

  return options;
};

/**
 * Function that will return the translation of the provided key
 * into the current language.
 * @param {string} key - ID of the expression to be translated
 * @returns {string} - The translated text
 */
export function getMsg(key) {
  return _messages[key] || key;
}

/**
 * Converts expressions of type 'pt-br', 'FR', 'ca_es@valencia'... to the format expected by the i18n system:
 * lc[_CC][@variant] where 'lc' is a two or three lowercase letter language code, CC is an optional two uppercase
 * letter country code, followed by an optional 'variant' consisting in letters and/or digits.
 * @param {string} locale - The locale expression to be normalized
 * @returns string - The normalized locale
 */
export function normalizeLocale(locale = '') {
  const [, language = null, country = null, variant = null] = /^([a-zA-Z]{2,3})[_-]?([a-zA-Z]{2})?@?([a-zA-Z0-9]*)?$/.exec(locale.trim()) || [];
  return language
    ? `${language.toLowerCase()}${country ? `_${country.toUpperCase()}` : ''}${variant ? `@${variant.toLowerCase()}` : ''}`
    : '';
};

/**
 * Checks if the language preferred by the user (based on browser and/or specific settings)
 * is in a list of available languages.
 * @param {string[]} availableLangs - Array of available languages. It should contain at least one item.
 * @param {string} [defaultLang=en] - Language to be used by default when not found the selected one
 * @param {string} [requestedLang=''] - Request this specific language
 * @returns {string} - The most suitable language for this request
 */
export function checkPreferredLanguage(availableLangs, defaultLang = 'en', requestedLang = '') {
  let result = -1;

  // Create an array to store possible values
  let tries = [];

  // If "setLang" is specified, check it
  if (requestedLang) {
    // Normalize requested locale
    const lang = normalizeLocale(requestedLang);
    if (lang)
      tries.push(lang);
  }

  // Add user's preferred languages, if any
  if (window.navigator.languages)
    tries = tries.concat(window.navigator.languages);

  // Add the navigator main language, if defined
  if (window.navigator.language)
    tries.push(window.navigator.language);

  // Add English as final option
  tries.push(defaultLang);

  for (let i = 0; i &lt; tries.length; i++) {
    let match = -1;
    for (let n in availableLangs) {
      if (tries[i].indexOf(availableLangs[n]) === 0) {
        match = n;
        if (tries[i] === availableLangs[n]) {
          result = n;
          break;
        }
      }
    }
    if (result >= 0 || (result = match) >= 0)
      break;
  }
  return availableLangs[result >= 0 ? result : 0];
};

/**
 * Establishes the current verbosity level of the logging system
 * @param {string} level - One of the valid strings in {@link module:Utils.LOG_LEVELS}
 */
export function setLogLevel(level) {
  const log = LOG_LEVELS.indexOf(level);
  if (log >= 0)
    LOG_OPTIONS.level = log;
};

/**
 * Reports a new message to the logging system
 * @param {string} type - The type of message. Mus be `error`, `warn`, `info`, `debug` or `trace`.
 * @param {string} msg - The main message to be logged. Additional parameters can be added, like
 * in `console.log` (see: {@link https://developer.mozilla.org/en-US/docs/Web/API/Console/log})
 */
export function log(type, msg) {
  const level = LOG_LEVELS.indexOf(type);
  const args = Array.prototype.slice.call(arguments);

  // Check if message should currently be logged
  if (level &lt; 0 || level &lt;= LOG_OPTIONS.level) {
    if (LOG_OPTIONS.pipeTo)
      LOG_OPTIONS.pipeTo.apply(null, args);
    else {
      const mainMsg = `${LOG_OPTIONS.prefix || ''} ${LOG_PRINT_LABELS[level]} ${LOG_OPTIONS.timestamp ? getDateTime() : ''} ${msg}`;
      console[level === 1 ? 'error' : level === 2 ? 'warn' : 'log'].apply(console, [mainMsg].concat(args.slice(2)));
      // Call chained logger, if anny
      if (LOG_OPTIONS.chainTo)
        LOG_OPTIONS.chainTo.apply(null, args);
    }
  }
};

/**
 * Gets a boolean value from a textual expression
 * @param {string} val - The value to be parsed (`true` for true, null or otherwise for `false`)
 * @param {boolean} [defaultValue=false] - The default value to return when `val` is false
 * @returns {number}
 */
export function getBoolean(val, defaultValue = false) {
  return val === 'true' ? true : val === 'false' ? false : defaultValue;
};

/**
 * Gets a value from an given expression that can be `null`, `undefined` or empty string ('')
 * @param {any} val - The expression to parse
 * @param {any} [defaultValue=null] - The value to return when `val` is `null`, `''` or `undefined`
 * @returns {any}
 */
export function getVal(val, defaultValue = null) {
  return (val === '' || val === null || typeof val === 'undefined') ? defaultValue : val;
};

/**
 * Gets a number from a string or another number
 * @param {any} val - The expression to parse
 * @param {number} [defaultValue=0] - The default value
 * @returns {number}
 */
export function getNumber(val, defaultValue) {
  return Number(getVal(val, defaultValue));
};

/**
 * Gets the plain percent expression (without decimals) of the given value
 * @param {number} val - The value to be expressed as a percentile
 * @returns {string}
 */
export function getPercent(val) {
  return `${Math.round(val * 100)}%`;
}

/**
 * Returns the two-digits text expression representing the given number (lesser than 100) zero-padded at left
 * Useful for representing hours, minutes and seconds
 * @param {number} val - The number to be processed
 * @returns {string}
 */
export function zp(val) {
  return `0${val}`.slice(-2);
};

/**
 * Returns a given time in [00h 00'00"] format
 * @param {number} millis - Amount of milliseconds to be processed
 * @returns {string}
 */
export function getHMStime(millis) {
  const d = new Date(millis);
  const h = d.getUTCHours(), m = d.getUTCMinutes(), s = d.getUTCSeconds();
  return `${h ? h + 'h ' : ''}${h || m ? zp(m) + '\'' : ''}${zp(s)}"`;
};

/**
 * Returns a formatted string with the provided date and time
 * @param {external:Date} date - The date to be formatted. When `null` or `undefined`, the current date will be used.
 * @returns {string}
 */
export function getDateTime(date = new Date()) {
  return `${date.getFullYear()}/${zp(date.getMonth() + 1)}/${zp(date.getDate())} ${zp(date.getHours())}:${zp(date.getMinutes())}:${zp(date.getSeconds())}`;
};

/**
 * Parse 'date' fields generated by "JClic Author" in format d/m/y, with
 * variable number of digits.
 * @param {string} text - The old 'date' field
 * @returns {external:Date} - Always return a Date object (now, if text was invalid)
 */
export function parseOldDate(text) {
  let result = null;
  if (text) {
    const elements = text.trim().split('/');
    if (elements.length === 3) {
      let m = parseInt(elements[0]) || 0;
      let d = parseInt(elements[1]) || 0;
      let y = parseInt(elements[2]) || 0;
      if (m > 12 &amp;&amp; d &lt;= 12) {
        const t = m;
        m = d;
        d = t;
      }
      if (y &lt; 1980)
        y += (y &lt; 90 ? 2000 : 1900);
      if (d &amp;&amp; m &amp;&amp; y) {
        result = new Date(Date.parse(`${m}/${d}/${y}`));
      }
    }
  }
  return result || new Date();
};

/**
 * Extracts just the ISO-639 language code from complex
 * expressions like "English (en)", buid by JClic Author.
 * @param {string} text - The expression to parse
 * @returns {string} - The ISO-639 language code, or '--' if none found
 */
export function cleanOldLanguageTag(text) {
  if (!text)
    text = '--';
  // Allow only ISO-639-1 and ISO-639-2 language codes
  else if (!text.match(/^[a-z][a-z][a-z]?$/)) {
    const matches = text.match(/\(([a-z][a-z][a-z]?)\)/);
    if (matches &amp;&amp; matches.length === 2)
      text = matches[1];
    else
      text = '--';
  }
  return text;
};

/** @const {number} */
export const FALSE = 0;

/** @const {number} */
export const TRUE = 1;

/** @const {number} */
export const DEFAULT = 2;

/**
 * Gets a numeric value (0, 1 or 2) from a set of possible values: `false`, `true` and `default`.
 * @param {string} val - The text to be parsed
 * @param {any} def - An optional default value
 * @returns {number}
 */
export function getTriState(val, def = DEFAULT) {
  return val === 'true' ? TRUE : val === 'false' ? FALSE : def;
};

/**
 * Returns a string with the given `tag` repeated n times
 * @param {string} tag - The tag to be repeated
 * @param {number} repeats - The number of times to repeat the tag
 * @returns {string}
 */
export function fillString(tag, repeats = 0) {
  return Array(repeats).fill(tag).join('');
};

/**
 * Checks if the provided value is 'null' or 'undefined'.
 * @param {any} val - The value to be parsed
 * @returns {boolean}
 */
export function isNullOrUndef(val) {
  return typeof val === 'undefined' || val === null;
};

/**
 * Checks if two expressions are equivalent.
 * Returns `true` when both parameters are `null` or `undefined`, and also when both have
 * equivalent values.
 * @param {any} a
 * @param {any} b
 * @returns {boolean}
 */
export function isEquivalent(a, b) {
  return (typeof a === 'undefined' || a === null) &amp;&amp; (typeof b === 'undefined' || b === null) || a === b;
};

/**
 * Reads paragraphs, identified by `&lt;p>&lt;/p>` elements, inside XML data
 * @param {object} xml - The DOM-XML element to be parsed
 * @returns {string}
 */
export function getXmlText(xml) {
  let text = '';
  $(xml).children('p').each((_n, child) => { text += `&lt;p>${child.textContent}&lt;/p>`; });
  return text;
};

/**
 * Parse the provided XML element node, returning a complex object
 * @param {object} xml - The root XML element to parse
 * @param {boolean} [withText=false] - When `true`, any text found inside the XML element is also included in the resulting object.
 * @returns {object}
 */
export function parseXmlNode(xml, withText = false) {
  // Initialize the resulting object
  const result = {};
  // Direct copy of root element attributes as object properties
  if (xml.attributes)
    attrForEach(xml.attributes, (name, value) => result[name] = /^-?\d*$/.test(value) ? Number(value) : value);

  const keys = [];
  const children = Array.from(xml.children || xml.childNodes || []);

  // If all children is of type 'p', just compile it in a single string
  const paragraphs = children.filter(child => child.nodeName === 'p');
  if (paragraphs.length > 0 &amp;&amp; paragraphs.length === children.filter(ch => ch.nodeName !== '#text').length) {
    const text = paragraphs.map(ch => ch.textContent).join('\n');
    if (xml.attributes) {
      result.text = text;
      return result;
    }
    return text;
  }

  // Process children elements
  children.forEach(child => {
    // Avoid extra text content collected by [xmldom](https://www.npmjs.com/package/xmldom)
    if (child.nodeName === '#text' &amp;&amp; !withText)
      return;

    // Recursive processing of children
    const ch = parseXmlNode(child, withText);
    // Store the result into a temporary object named as the child node name,
    if (!result[child.nodeName]) {
      // Create object and save key for later processing
      result[child.nodeName] = {};
      keys.push(child.nodeName);
    }
    // Use 'id' (or an incremental number if 'id' is not set) as a key
    if (ch.id)
      result[child.nodeName][ch.id] = ch;
    else {
      const n = Object.keys(result[child.nodeName]).length;
      result[child.nodeName][n] = ch;
    }
  });
  // Check temporary objects, converting it to an array, a single object or a complex object
  keys.forEach(k => {
    // Retrieve temporary object from `keys`
    const kx = Object.keys(result[k]);
    // If all keys are numbers, convert object into an array (or leave it as a single object)
    if (!kx.find(kk => isNaN(kk))) {
      if (kx.length === 1)
        // Array with a single element. Leave it as a simple object:
        result[k] = result[k][0];
      else {
        // Object with numeric keys. Convert it to array:
        const arr = [];
        kx.forEach(kk => arr.push(result[k][kk]));
        result[k] = arr;
      }
    }
  });
  // Save text content, if any:
  if (children.length === 0 &amp;&amp; xml.textContent)
    result.textContent = xml.textContent;
  return result;
};

/**
 * Parse the given XML node, known as containing only text elements,
 * and return its content as a string (when possible)
 * @param {object} xml - The XML element to parse
 * @returns {string|object}
 */
export function getXmlNodeText(node) {
  const result = parseXmlNode(node);
  return typeof result === 'string' ?
    result :
    result.hasOwnProperty('text') ?
      result.text :
      result.hasOwnProperty('textContent') ?
        result.textContent :
        result;
};

/**
 * Recursively explore the given object, converting to a string
 * all attributes with a single attribute named 'text'.
 * Example:
 * {a:1, b:{text:"hello"}, c:{d:2, text:"world"}} => {a:1, b:"hello", c:{d:2, text:"world"}}
 * @param {object} obj - The object to explore
 * @returns {object} - The same object, with text attributes reduced to strings
 */
export function reduceTextsToStrings(obj) {
  if (obj) {
    const keys = Object.keys(obj);
    keys.forEach(k => {
      const attr = obj[k];
      if (typeof attr === 'object') {
        const ko = Object.keys(attr);
        if (ko.length === 1 &amp;&amp; ko[0] === 'text')
          obj[k] = attr.text;
        else
          obj[k] = reduceTextsToStrings(attr);
      }
    });
  }
  return obj;
};

/**
 * Creates a string suitable to be used in the 'style' attribute of HTML tags, filled with the
 * CSS attributes contained in the provided object.
 * @param {object} cssObj
 * @returns {string}
 */
export function cssToString(cssObj) {
  return Object.keys(cssObj).reduce((s, key) => `${s}${key}:${cssObj[key]};`, '');
};

/**
 * Converts java-like color codes (like '0xRRGGBB') to valid CSS values like '#RRGGBB' or 'rgba(r,g,b,a)'
 * @param {string} [color] - A color, as codified in Java
 * @param {string} [defaultColor] - The default color to be used
 * @returns {string}
 */
export function checkColor(color, defaultColor = settings.BoxBase.BACK_COLOR) {
  if (typeof color === 'undefined' || color === null)
    color = defaultColor;
  color = color.replace('0x', '#');
  // Check for Alpha value
  if (color.charAt(0) === '#' &amp;&amp; color.length > 7) {
    const alpha = fx(parseInt(color.substring(1, 3), 16) / 255.0, 2);
    color = `rgba(${parseInt(color.substring(3, 5), 16)},${parseInt(color.substring(5, 7), 16)},${parseInt(color.substring(7, 9), 16)},${alpha})`;
  }
  return color;
};

/**
 * Checks if the provided color has an alpha value less than 1
 * @param {string} color - The color to be analyzed
 * @returns {boolean}
 */
export function colorHasTransparency(color) {
  if (startsWith(color, 'rgba(')) {
    var alpha = parseInt(color.substr(color.lastIndexOf(',')));
    return typeof alpha === 'number' &amp;&amp; alpha &lt; 1.0;
  }
  return false;
};

/**
 * Clones the provided object
 * See: https://stackoverflow.com/questions/41474986/how-to-clone-a-javascript-es6-class-instance
 * @param {object} obj
 * @returns {object}
 */
//cloneObject: obj => Object.assign(Object.create(Object.getPrototypeOf(obj)), obj),
export function cloneObject(obj) {
  return $.extend(true, Object.create(Object.getPrototypeOf(obj)), obj);
};

/**
 * Converts string values to number or boolean when needed
 * @param {object} obj - The object to be processed
 * @returns {object} - A new object with normalized content
 */
export function normalizeObject(obj) {
  const result = {};
  if (obj)
    $.each(obj, (key, value) => {
      let s;
      if (typeof value === 'string' &amp;&amp; (s = value.trim().toLowerCase()) !== '')
        value = s === 'true' ? true : s === 'false' ? false : isNaN(s) ? value : Number(s);
      result[key] = value;
    });
  return result;
};

/**
 * Returns an partial clone of an object, containing only the own attributes specified in an array of possible keys.
 * When the value of an attribute is of type 'Object' and this object has a method named `getAttributes`, the result of calling
 * this method is returned instead of the crude object.
 * @param {object} obj - The object to be processed
 * @param {string[]} [keys] - An optional array of keys to be included in the resulting object.
 * When null or not set, all keys of `obj` are included. Keys can include a default value separed by '|'.
 * Attributes with default value will be excluded from the resulting object.
 * @returns {object}
 */
export function getAttr(obj, keys = null) {
  let result = {};
  keys = keys || Object.keys(obj);
  keys.forEach(key => {
    const [k, d] = key.split('|');
    if (obj.hasOwnProperty(k) &amp;&amp; typeof obj[k] !== 'undefined' &amp;&amp; obj[k] !== null &amp;&amp; obj[k].toString() !== d) {
      const v = getValue(obj[k]);
      if (!isEmpty(v))
        result[k] = v;
    }
  });

  // Convert to string objects with only a "text" attribute
  keys = Object.keys(result);
  if (keys.length === 1 &amp;&amp; keys[0] === 'text')
    result = result.text;

  return result;
};

/**
 * Gets the minimal representation of the given value (object, array, string, number...)
 * @param {any} value - The value to be processed
 * @returns {any}
 */
export function getValue(value) {
  return value.getAttributes ?
    value.getAttributes() :
    value instanceof Array ?
      value.map(e => getValue(e)) :
      value instanceof Date ?
        value.toISOString() :
        value instanceof Object ?
          getAttr(value) :
          value;
};

/**
 * Checks if the given value is an empty object, null or a zero-length string
 * @param {any} v - The value to be checked
 * @returns {boolean} - `true` if `v` is `{}`, `null` or `""`
 */
export function isEmpty(v) {
  let result = (typeof v === 'undefined' || v === null);
  if (!result) {
    switch (typeof v) {
      case 'object':
        result = Object.keys(v).length === 0;
        break;

      case 'string':
        result = v.length === 0;
        break;
    }
  }
  return result;
};

/**
 * Fills an object with specific attributes from another data object
 * @param {object} obj - The target object
 * @param {object} data - The data object
 * @param {string[]} attr - The list of attributes to be copied from `data` to `obj`
 *                          Elements of this list can be:
 *                          a) Just a string. In this case, the native object will be used as a value
 *                          b) An object with the following members:
 *                          - `key`{string} - The attribute name
 *                          - `fn` {function} - The function to be invoked to build the object
 *                          - `params` {string[]} - Optional params to be passed to the `setAttributes` method of the created object
 *                          - `group` {string} - Used when `data` is an object or an array (possible values are `object` and `array`), and multiple results
 *                                               should be aggregated in a resulting object or array with the same keys (or ordering) as data.
 *                          - `init` {string} - Optional parameter indicating if `fn` should be passed with an additional param. This param can be:
 *                            - `key` - The member's key
 *
 * @returns {object} - Always returns `obj`
 */
export function setAttr(obj, data, attr) {
  attr.forEach(a => {
    if (a.key) {
      const { key, fn, group, init, params } = a;
      // A new object should be built
      if (!isEmpty(data[key])) {
        const dataset = data[key];
        if (group === 'object')
          obj[key] = Object.keys(dataset).reduce((o, k) => {
            o[k] = buildObj(fn, dataset[k], init === 'key' ? k : init, params);
            return o;
          }, {});
        else if (group === 'array')
          obj[key] = dataset.map((element, n) => buildObj(fn, element, init === 'key' ? n : init, params));
        else
          obj[key] = buildObj(fn, dataset, init, params);
      }
    } else if (!isEmpty(data[a]))
      obj[a] = data[a];
  });
  return obj;
};

/**
 * Builds a new object based on the provided constructor, data and initialization value
 * Objects used with this function should implement `setAttributes`, or an static method named `factory`
 * @param {function} objType - A class or function to be invoked to build the object.
 * @param {object} [data] - An optional object filled with the attributes to be assigned to the newly created object.
 * @param {any} [init] - An optional value to be passed to the function when invoked with `new`
 * @param {object[]} [params=[]] - Optional array of params to be passed when calling `setAttributes` on the final object
 * @returns {object} - The resulting object
 */
export function buildObj(objType, data, init, params = []) {
  return objType.factory ? objType.factory(data, init, params) : new objType(init).setAttributes(data, ...params);
};

/**
 * Check if the given char is a separator
 * @param {string} ch - A string with a single character
 * @returns {boolean}
 */
export function isSeparator(ch) {
  return settings.SEPARATORS.includes(ch);
};

/**
 * Check if the given char is a word delimiter
 * @param {string} ch - A string with a single character
 * @returns {boolean}
 */
export function isWordDelimiter(ch) {
  return settings.WORD_DELIMITERS.includes(ch);
}

/**
 * Converts a string in an array of objects with 'text' and 'sep' attributes, where 'text' are single words and 'sep'
 * are the word separators following each word in the sentence.
 * @example
 * stringToWords("Hello, World! That's all") returns:
 * [
 *   {text: "Hello", sep: ", "},
 *   {text: "World", sep: "! "},
 *   {text: "That", sep: "'"},
 *   {text: "s", sep: " "},
 *   {text: "all", sep: ""},
 * ]
 * @param {*} str - The text to be tokenized
 * @returns {object[]}
 */
export function stringToWords(str) {
  const result = [];
  let token = { text: '', sep: '' };
  let inWord = true;
  for (let i = 0; i &lt; str.length; i++) {
    const ch = str.charAt(i);
    const delim = isWordDelimiter(ch);
    if (inWord) {
      if (!delim)
        token.text += ch;
      else {
        inWord = false;
        token.sep = ch;
      }
    } else {
      if (delim)
        token.sep += ch;
      else {
        result.push(token);
        token = { text: ch, sep: '' };
        inWord = true;
      }
    }
  }
  result.push(token);
  return result;
}

/**
 * Rounds `v` to the nearest multiple of `n`
 * @param {number} v
 * @param {number} n - Cannot be zero!
 * @returns {number}
 */
export function roundTo(v, n) {
  return Math.round(v / n) * n;
};

/**
 * Set the maximum number of decimals for a number
 * @param {any} v - The value to be converted to a fixed number of decimals. Can be anything.
 * @param {number} n=4 - the maximum number of decimals
 * @returns {any} - When `v` is a number, a number with fixed decimals is returned. Otherwise, returns `v`
 */
export function fx(v, n = 4) {
  return v.toFixed ? Number(v.toFixed(n)) : v;
};

/**
 * Compares the provided answer against multiple valid options. These valid options are
 * concatenated in a string, separated by pipe chars (`|`). The comparing can be case sensitive.
 * @param {string} answer - The text to check against to
 * @param {string} check - String containing one or multiple options, separated by `|`
 * @param {boolean} [checkCase=false] - When true, the comparing will be case-sensitive
 * @param {boolean} [numeric=false] - When true, we are comparing numeric expressions
 * @returns {boolean}
 */
export function compareMultipleOptions(answer, check, checkCase = false, numeric = false) {
  if (answer === null || answer.length === 0 || check === null || check.length === 0)
    return false;
  if (!checkCase &amp;&amp; !numeric)
    answer = answer.toUpperCase();
  answer = answer.trim();

  // Check for numeric digits in answer!
  numeric = numeric &amp;&amp; /\d/.test(answer);

  for (let token of check.split('|')) {
    if (numeric) {
      if (Number.parseFloat(answer.replace(/,/, '.')) === Number.parseFloat(token.replace(/,/, '.')))
        return true;
    }
    else if (answer === (checkCase ? token : token.toUpperCase()).trim())
      return true;
  }
  return false;
};

/**
 * Checks if the given string ends with the specified expression
 * @param {string} text - The string where to find the expression
 * @param {string} expr - The expression to search for.
 * @param {boolean} [trim] - When `true`, the `text` string will be trimmed before check
 * @returns {boolean}
 */
export function endsWith(text = '', expr, trim) {
  return typeof text === 'string' &amp;&amp; (trim ? text.trim() : text).endsWith(expr);
};

/**
 * Checks if the given string starts with the specified expression
 * @param {string} text - The string where to find the expression
 * @param {string} expr - The expression to search for.
 * @param {boolean} [trim] - When `true`, the `text` string will be trimmed before check
 * @returns {boolean}
 */
export function startsWith(text = '', expr, trim) {
  return typeof text === 'string' &amp;&amp; (trim ? text.trim() : text).indexOf(expr) === 0;
};

/**
 * Replaces all occurrences of the backslash character (`\`) by a regular slash (`/`)
 * This is useful to normalize bad path names present in some old JClic projects
 * @param {string} str - The string to be normalized
 * @returns {string}
 */
export function nSlash(str) {
  return str ? str.replace(/\\/g, '/') : str;
};

/**
 * Checks if the given expression is an absolute URL
 * @param {string} exp - The expression to be checked
 * @returns {boolean}
 */
export function isURL(exp) {
  return /^(filesystem:)?(https?|file|data|ftps?):/i.test(exp);
};

/**
 * Gets the base path of the given file path (absolute or full URL). This base path always ends
 * with `/`, meaning it can be concatenated with relative paths without adding a separator.
 * @param {string} path - The full path to be parsed
 * @returns {string}
 */
export function getBasePath(path) {
  const p = path.lastIndexOf('/');
  return p >= 0 ? path.substring(0, p + 1) : '';
};

/**
 * Gets the full path of `file` relative to `basePath`
 * @param {string} file - The file name
 * @param {string} [path] - The base path
 * @returns {string}
 */
export function getRelativePath(file, path) {
  return (!path || path === '' || file.indexOf(path) !== 0) ? file : file.substr(path.length);
};

/**
 * Gets the complete path of a relative or absolute URL, using the provided `basePath`
 * @param {string} basePath - The base URL
 * @param {string} path - The filename
 * @returns {string}
 */
export function getPath(basePath, path) {
  return isURL(path) ? path : basePath + path;
};

/**
 * Gets a promise with the complete path of a relative or absolute URL, using the provided `basePath`
 * @param {string} basePath - The base URL
 * @param {string} path - The filename
 * @param {external:JSZip} [zip] - An optional {@link external:JSZip} object where to look
 * for the file
 * @returns {external:Promise}
 */
export function getPathPromise(basePath, path, zip) {
  if (zip) {
    const fName = getRelativePath(basePath + path, zip.zipBasePath);
    if (zip.files[fName]) {
      return new Promise((resolve, reject) => {
        zip.file(fName).async('base64').then(data => {
          const ext = path.toLowerCase().split('.').pop();
          const mime = settings.MIME_TYPES[ext] || 'application/octet-stream';
          resolve(`data:${mime};base64,${data}`);
        }).catch(reject);
      });
    }
  }
  return Promise.resolve(getPath(basePath, path));
};

/**
 * Utility object that provides several methods to build simple and complex DOM objects
 * @type {object}
 */
export const $HTML = {
  doubleCell: (a, b) => $('&lt;tr/>').append($('&lt;td/>').html(a)).append($('&lt;td/>').html(b)),
  p: txt => $('&lt;p/>').html(txt),
  td: (txt, className) => $('&lt;td/>', className ? { class: className } : null).html(txt),
  th: (txt, className) => $('&lt;th/>', className ? { class: className } : null).html(txt),
};

/**
 * Replaces `width`, `height` and `fill` attributes of a simple SVG image
 * with the provided values
 * @param {string} svg - The SVG image as XML string
 * @param {string} [width] - Optional setting for "width" property
 * @param {string} [height] - Optional setting for "height" property
 * @param {string} [fill] - Optional setting for "fill" property
 * @returns {string} - The resulting svg code
 */
export function getSvg(svg, width, height, fill) {
  if (width)
    svg = svg.replace(/width=\"\d*\"/, `width="${width}"`);
  if (height)
    svg = svg.replace(/height=\"\d*\"/, `height="${height}"`);
  if (fill)
    svg = svg.replace(/fill=\"[#A-Za-z0-9]*\"/, `fill="${fill}"`);
  return svg;
};

/**
 * Encodes a svg expression into a {@link https://developer.mozilla.org/en-US/docs/Web/HTTP/data_URIs|data URI}
 * suitable for the `src` property of `img` elements, optionally changing its original size and fill values.
 * @param {string} svg - The SVG image as XML string
 * @param {string} [width] - Optional setting for "width" property
 * @param {string} [height] - Optional setting for "height" property
 * @param {string} [fill] - Optional setting for "fill" property
 * @returns {string} - The resulting Data URI
 */
export function svgToURI(svg, width, height, fill) {
  return 'data:image/svg+xml;base64,' + window.btoa(getSvg(svg, width, height, fill));
};

/**
 * Converts the given expression into a valid value for CSS size values
 * @param {string|number} exp - The expression to be evaluated. Can be a numeric value, `null` or `undefined`.
 *                              Positive values are in "px" units, negative ones are "%"
 * @param {object} css - An optional Object where the resulting expression (if any) will be saved
 * @param {string} key - The key under which the result will be stored in `css`
 * @param {string} def - Default value to be used when `exp` is `null` or `undefined`
 * @returns {string} - A valid CSS value, or `null` if it can't be found. Default units are `px`
 */
export function toCssSize(exp, css, key, def) {
  const result = typeof exp === 'undefined' || exp === null ? null : isNaN(exp) ? exp : exp &lt; 0 ? `${Math.abs(exp)}%` : `${exp}px`;
  if (css &amp;&amp; key &amp;&amp; (result || def))
    css[key] = result !== null ? result : def;
  return result;
};

/**
 * Gets a clip of the give image data, in a URL base64 encoded format
 * @param {object} img - The binary data of the realized image, usually obtained from a {@link module:bads/MediaBagElement.MediaBagElement}
 * @param {module:AWT.Rectangle} rect - A rectangle containing the requested clip
 * @returns {string} - The URL with the image clip, as a PNG file encoded in base64
 */
export function getImgClipUrl(img, rect) {
  const canvas = document.createElement('canvas');
  canvas.width = rect.dim.width;
  canvas.height = rect.dim.height;
  const ctx = canvas.getContext('2d');
  let result = '';
  try {
    ctx.drawImage(img, rect.pos.x, rect.pos.y, rect.dim.width, rect.dim.height, 0, 0, rect.dim.width, rect.dim.height);
    result = canvas.toDataURL();
  } catch (err) {
    // catch 'tainted canvases may not be exported' and other errors
    log('error', err);
  }
  return result;
};

/**
 * Finds the nearest `head` or root node of a given HTMLElement, useful to place `&lt;style/>` elements when
 * the main component of JClic is behind a shadow-root.
 * This method will be replaced by a call to [Node.getRootNode()](https://developer.mozilla.org/en-US/docs/Web/API/Node/getRootNode)
 * when fully supported by all major browsers.
 * @param {external:HTMLElement} [el] - The element from which to start the search
 * @returns {external:HTMLElement}
 */
export function getRootHead(el) {
  if (el) {
    // Skip HTMLElements
    while (el.parentElement)
      el = el.parentElement;
    // Get the parent node of the last HTMLElement
    if (el instanceof HTMLElement)
      el = el.parentNode || el;
    // If the root node has a `head`, take it
    el = el['head'] || el;
  }
  return el || document.head;
};

/**
 * Appends a stylesheet element to the `head` or root node nearest to the given `HTMLElement`.
 * @param {string} css - The content of the stylesheet
 * @param {module:JClicPlayer.JClicPlayer} [ps] - An optional `PlayStation` (currently a {@link module:JClicPlayer.JClicPlayer JClicPlayer}) used as a base to find the root node
 * @returns {external:HTMLStyleElement} - The appended style element
 */
export function appendStyleAtHead(css, ps) {
  const root = getRootHead(ps &amp;&amp; ps.$topDiv ? ps.$topDiv[0] : null);
  const style = document.createElement('style');
  style.type = 'text/css';
  style.appendChild(document.createTextNode(css));
  return root.appendChild(style);
};

/**
 * Traverses all the attributes defined in an Element, calling a function with its name and value as a parameters
 * @param {external:NamedNodeMap} attributes - The [Element.attributes](https://developer.mozilla.org/en-US/docs/Web/API/Element/attributes)
 * object to be traversed
 * @param {function} callback - The function to be called for each [Attr](https://developer.mozilla.org/en-US/docs/Web/API/NamedNodeMap)
 * object. It should take two parametres: `name` and `value`
 */
export function attrForEach(attributes, callback) {
  for (let i = 0; i &lt; attributes.length; i++)
    callback(attributes[i].name, attributes[i].value);
};

/**
 * Recursive traversal of all nodes of the given object looking for children having the `childName` attribute
 * WARNING: Don't call this method on objects with circular dependencies!
 * @param {object} obj       - The object to be analized
 * @param {string} childName - Name of the attribute to search for
 * @returns {object[]}       - Array of children having the searched attribute
 */
export function findParentsWithChild(obj, childName, _result = []) {
  if (obj[childName])
    _result.push(obj);
  else
    Object.values(obj).forEach(val => {
      if (typeof val === 'object')
        findParentsWithChild(val, childName, _result);
    });
  return _result;
};

//
// Functions useful to deal with caret position in `contentEditable` DOM elements
//
/**
 * Gets the caret position within the given element. Thanks to
 * {@link http://stackoverflow.com/users/96100/tim-down|Tim Down} answers in:
 * {@link http://stackoverflow.com/questions/4811822/get-a-ranges-start-and-end-offsets-relative-to-its-parent-container}
 * and {@link http://stackoverflow.com/questions/6240139/highlight-text-range-using-javascript/6242538}
 * @param {object} element - A DOM element
 * @returns {number}
 */
export function getCaretCharacterOffsetWithin(element) {
  let caretOffset = 0;
  const doc = element.ownerDocument || element.document;
  const win = doc.defaultView || doc.parentWindow;
  let sel;
  if (typeof win.getSelection !== "undefined") {
    sel = win.getSelection();
    if (sel.rangeCount > 0) {
      const range = win.getSelection().getRangeAt(0);
      const preCaretRange = range.cloneRange();
      preCaretRange.selectNodeContents(element);
      preCaretRange.setEnd(range.endContainer, range.endOffset);
      caretOffset = preCaretRange.toString().length;
    }
  } else if ((sel = doc.selection) &amp;&amp; sel.type !== "Control") {
    const textRange = sel.createRange();
    const preCaretTextRange = doc.body.createTextRange();
    preCaretTextRange.moveToElementText(element);
    preCaretTextRange.setEndPoint("EndToEnd", textRange);
    caretOffset = preCaretTextRange.text.length;
  }
  return caretOffset;
};

/**
 * Utility function called by {@link module:Utils.getCaretCharacterOffsetWithin}
 * @param {object} node - A text node
 * @returns {object[]}
 */
export function getTextNodesIn(node) {
  const textNodes = [];
  if (node.nodeType === 3) {
    textNodes.push(node);
  } else {
    const children = node.childNodes;
    for (let i = 0, len = children.length; i &lt; len; ++i) {
      textNodes.push.apply(textNodes, getTextNodesIn(children[i]));
    }
  }
  return textNodes;
};

/**
 * Sets the selection range (or the cursor position, when `start` and `end` are the same) to a
 * specific position inside a DOM element.
 * @param {object} el - The DOM element where to set the cursor
 * @param {number} start - The start position of the selection (or cursor position)
 * @param {number} end - The end position of the selection. When null or identical to `start`,
 * indicates a cursor position.
 */
export function setSelectionRange(el, start, end) {
  if (isNullOrUndef(end))
    end = start;
  if (document.createRange &amp;&amp; window.getSelection) {
    const range = document.createRange();
    range.selectNodeContents(el);
    const textNodes = getTextNodesIn(el);
    let foundStart = false;
    let charCount = 0, endCharCount, textNode;

    for (let i = 0; i &lt; textNodes.length; i++) {
      textNode = textNodes[i];
      endCharCount = charCount + textNode.length;
      if (!foundStart &amp;&amp; start >= charCount &amp;&amp;
        (start &lt; endCharCount ||
          start === endCharCount &amp;&amp; i + 1 &lt;= textNodes.length)) {
        range.setStart(textNode, start - charCount);
        foundStart = true;
      }
      if (foundStart &amp;&amp; end &lt;= endCharCount) {
        range.setEnd(textNode, end - charCount);
        break;
      }
      charCount = endCharCount;
    }
    const sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);
  } else if (document.selection &amp;&amp; document.body.createTextRange) {
    const textRange = document.body.createTextRange();
    textRange.moveToElementText(el);
    textRange.collapse(true);
    textRange.moveEnd('character', end);
    textRange.moveStart('character', start);
    textRange.select();
  }
};

/**
 * Performs multiple replacements on the provided string
 * See: https://stackoverflow.com/questions/2501435/replacing-multiple-patterns-in-a-block-of-data
 * @param {Object[]} replacements - Array of pairs formed by an "expression" (regexp or string) and a "value" (string) to replace the fragments found
 * @param {String} str - The string to be checked for replacements
 * @returns {String} - The original string with the fragments found already replaced
 */
export function mReplace(replacements, str) {
  return replacements.reduce((result, [exp, replacement]) => result.replace(exp, replacement), str);
};

/**
 * Global constants
 * @const
 */
export const settings = {
  // JClic.js Version
  VERSION: GlobalData.version,
  // Check if we are running on NodeJS with JSDOM
  NODEJS: window.name === 'nodejs',
  // layout constants
  AB: 0, BA: 1, AUB: 2, BUA: 3,
  LAYOUT_NAMES: ['AB', 'BA', 'AUB', 'BUA'],
  DEFAULT_WIDTH: 400,
  DEFAULT_HEIGHT: 300,
  MINIMUM_WIDTH: 40,
  MINIMUM_HEIGHT: 40,
  DEFAULT_NAME: '---',
  DEFAULT_MARGIN: 8,
  DEFAULT_SHUFFLES: 31,
  DEFAULT_GRID_ELEMENT_SIZE: 20,
  MIN_CELL_SIZE: 10,
  //DEFAULT_BG_COLOR: '#D3D3D3', // LightGray
  DEFAULT_BG_COLOR: '#C0C0C0', // LightGray
  ACTIONS: {
    ACTION_MATCH: 'MATCH', ACTION_PLACE: 'PLACE',
    ACTION_WRITE: 'WRITE', ACTION_SELECT: 'SELECT', ACTION_HELP: 'HELP'
  },
  PREVIOUS: 0, MAIN: 1, END: 2, END_ERROR: 3, NUM_MSG: 4,
  MSG_TYPE: ['previous', 'initial', 'final', 'finalError'],
  RANDOM_CHARS: "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
  NUM_COUNTERS: 3,
  MAX_RECORD_LENGTH: 180,
  // BoxBase defaults
  BoxBase: {
    REDUCE_FONT_STEP: 1.0,
    MIN_FONT_SIZE: 8,
    STROKE: 1,
    AC_MARGIN: 6,
    //BACK_COLOR: 'lightgray',
    BACK_COLOR: '#C0C0C0',
    TEXT_COLOR: 'black',
    SHADOW_COLOR: 'gray',
    INACTIVE_COLOR: 'gray',
    ALTERNATIVE_COLOR: 'gray',
    BORDER_COLOR: 'black',
    BORDER_STROKE_WIDTH: 0.75,
    MARKER_STROKE_WIDTH: 2.75
  },
  FILE_TYPES: {
    image: 'gif,jpg,png,jpeg,bmp,ico,svg',
    audio: 'wav,mp3,ogg,oga,au,aiff,flac',
    video: 'avi,mov,mpeg,mp4,ogv,m4v,webm',
    font: 'ttf,otf,eot,woff,woff2',
    midi: 'mid,midi',
    anim: 'swf',
    // Used in custom skins
    xml: 'xml'
  },
  MIME_TYPES: {
    xml: 'text/xml',
    gif: 'image/gif',
    jpg: 'image/jpeg',
    jpeg: 'image/jpeg',
    png: 'image/png',
    bmp: 'image/bmp',
    svg: 'image/svg+xml',
    ico: 'image/x-icon',
    wav: 'audio/wav',
    mp3: 'audio/mpeg',
    mp4: 'video/mp4',
    m4v: 'video/mp4',
    ogg: 'audio/ogg',
    oga: 'audio/ogg',
    ogv: 'video/ogg',
    webm: 'video/webm',
    au: 'audio/basic',
    aiff: 'audio/x-aiff',
    flac: 'audio/flac',
    avi: 'video/avi',
    mov: 'video/quicktime',
    mpeg: 'video/mpeg',
    ttf: 'application/font-sfnt',
    otf: 'application/font-sfnt',
    eot: ' application/vnd.ms-fontobject',
    woff: 'application/font-woff',
    woff2: 'application/font-woff2',
    swf: 'application/x-shockwave-flash',
    mid: 'audio/midi',
    midi: 'audio/midi'
  },
  // Global settings susceptible to be modified
  COMPRESS_IMAGES: true,
  // Keyboard key codes
  VK: {
    LEFT: 37,
    UP: 38,
    RIGHT: 39,
    DOWN: 40
  },
  // Flag to indicate that we are running on a touch device
  TOUCH_DEVICE: false,
  // Amount of time (in milliseconds) to wait before a media resource is loaded
  LOAD_TIMEOUT: 10000,
  // Number of points to be calculated as polygon vertexs when simplifying bezier curves
  BEZIER_POINTS: 4,
  // Check if canvas accessibility features are enabled
  // See: http://codepen.io/francesc/pen/amwvRp
  // UPDATED May 2020: Detection removed since Canvas HitRegions have been deprecated
  // See: https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Hit_regions_and_accessibility
  //
  // CANVAS_HITREGIONS: typeof CanvasRenderingContext2D !== 'undefined' &amp;&amp; typeof CanvasRenderingContext2D.prototype.addHitRegion === 'function',
  // CANVAS_HITREGIONS_FOCUS: typeof CanvasRenderingContext2D !== 'undefined' &amp;&amp; typeof CanvasRenderingContext2D.prototype.drawFocusIfNeeded === 'function',
  //
  CANVAS_DRAW_FOCUS: typeof window.CanvasRenderingContext2D !== 'undefined' &amp;&amp; typeof window.CanvasRenderingContext2D.prototype.drawFocusIfNeeded === 'function',
  // See: https://emptycharacter.com/
  // See: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions/Character_Classes
  WHITESPACES: '  \f\n\r\t\v\u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u2028\u2029\u202f\u205f\u3000\ufeff',
};
settings.SEPARATORS = `${settings.WHITESPACES}.,;-|`;
settings.WORD_DELIMITERS = `${settings.SEPARATORS}_&lt;>"'\xB4\x60\u2018\u2019\u2022~+\u2013\u2014\u2015=%?!:/\\()[]{}$`;

/**
 * Miscellaneous utility functions and constants
 */
export const Utils = {
  pkg,
  settings,
  getMsg,
  LOG_LEVELS,
  LOG_PRINT_LABELS,
  LOG_OPTIONS,
  init,
  setLogLevel,
  log,
  getBoolean,
  getVal,
  getNumber,
  getPercent,
  zp,
  getHMStime,
  getDateTime,
  parseOldDate,
  cleanOldLanguageTag,
  FALSE,
  TRUE,
  DEFAULT,
  getTriState,
  fillString,
  isNullOrUndef,
  isEquivalent,
  getXmlText,
  parseXmlNode,
  getXmlNodeText,
  reduceTextsToStrings,
  cssToString,
  checkColor,
  colorHasTransparency,
  cloneObject,
  normalizeObject,
  getAttr,
  getValue,
  isEmpty,
  setAttr,
  buildObj,
  isSeparator,
  isWordDelimiter,
  stringToWords,
  roundTo,
  fx,
  compareMultipleOptions,
  endsWith,
  startsWith,
  nSlash,
  isURL,
  getBasePath,
  getRelativePath,
  getPath,
  getPathPromise,
  $HTML,
  getSvg,
  svgToURI,
  toCssSize,
  getImgClipUrl,
  getRootHead,
  appendStyleAtHead,
  attrForEach,
  findParentsWithChild,
  getCaretCharacterOffsetWithin,
  getTextNodesIn,
  setSelectionRange
};

export default Utils;
</code></pre></article></section></div></div></div><div class="search-container" id="PkfLWpAbet" style="display:none"><div class="wrapper" id="iCxFxjkHbP"><button class="icon-button search-close-button" id="VjLlGakifb" aria-label="close search"><svg><use xlink:href="#close-icon"></use></svg></button><div class="search-box-c"><svg><use xlink:href="#search-icon"></use></svg> <input type="text" id="vpcKVYIppa" class="search-input" placeholder="Search..." autofocus></div><div class="search-result-c" id="fWwVHRuDuN"><span class="search-result-c-text">Type anything to view search result</span></div></div></div><div class="mobile-menu-icon-container"><button class="icon-button" id="mobile-menu" data-isopen="false" aria-label="menu"><svg><use xlink:href="#menu-icon"></use></svg></button></div><div id="mobile-sidebar" class="mobile-sidebar-container"><div class="mobile-sidebar-wrapper"><a href="/" class="sidebar-title sidebar-title-anchor">Home</a><div class="mobile-nav-links"></div><div class="mobile-sidebar-items-c"><div class="sidebar-section-title with-arrow" data-isopen="false" id="qHlACl8CFdcBMSnoHvrhv"><div>Modules</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="module-AWT.html">AWT</a></div><div class="sidebar-section-children"><a href="module-Activity.html">Activity</a></div><div class="sidebar-section-children"><a href="module-JClic.html">JClic</a></div><div class="sidebar-section-children"><a href="module-JClicPlayer.html">JClicPlayer</a></div><div class="sidebar-section-children"><a href="module-PlayerHistory.html">PlayerHistory</a></div><div class="sidebar-section-children"><a href="module-Utils.html">Utils</a></div><div class="sidebar-section-children"><a href="module-activities_associations_ComplexAssociation.html">activities/associations/ComplexAssociation</a></div><div class="sidebar-section-children"><a href="module-activities_associations_SimpleAssociation.html">activities/associations/SimpleAssociation</a></div><div class="sidebar-section-children"><a href="module-activities_memory_MemoryGame.html">activities/memory/MemoryGame</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Explore.html">activities/panels/Explore</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Identify.html">activities/panels/Identify</a></div><div class="sidebar-section-children"><a href="module-activities_panels_InformationScreen.html">activities/panels/InformationScreen</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Menu.html">activities/panels/Menu</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_DoublePuzzle.html">activities/puzzles/DoublePuzzle</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_ExchangePuzzle.html">activities/puzzles/ExchangePuzzle</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_HolePuzzle.html">activities/puzzles/HolePuzzle</a></div><div class="sidebar-section-children"><a href="module-activities_text_Complete.html">activities/text/Complete</a></div><div class="sidebar-section-children"><a href="module-activities_text_Evaluator.html">activities/text/Evaluator</a></div><div class="sidebar-section-children"><a href="module-activities_text_FillInBlanks.html">activities/text/FillInBlanks</a></div><div class="sidebar-section-children"><a href="module-activities_text_IdentifyText.html">activities/text/IdentifyText</a></div><div class="sidebar-section-children"><a href="module-activities_text_OrderText.html">activities/text/OrderText</a></div><div class="sidebar-section-children"><a href="module-activities_text_TextActivityBase.html">activities/text/TextActivityBase</a></div><div class="sidebar-section-children"><a href="module-activities_text_TextActivityDocument.html">activities/text/TextActivityDocument</a></div><div class="sidebar-section-children"><a href="module-activities_text_WrittenAnswer.html">activities/text/WrittenAnswer</a></div><div class="sidebar-section-children"><a href="module-activities_textGrid_CrossWord.html">activities/textGrid/CrossWord</a></div><div class="sidebar-section-children"><a href="module-activities_textGrid_WordSearch.html">activities/textGrid/WordSearch</a></div><div class="sidebar-section-children"><a href="module-automation_AutoContentProvider.html">automation/AutoContentProvider</a></div><div class="sidebar-section-children"><a href="module-automation_arith_Arith.html">automation/arith/Arith</a></div><div class="sidebar-section-children"><a href="module-bags_ActivitySequence.html">bags/ActivitySequence</a></div><div class="sidebar-section-children"><a href="module-bags_ActivitySequenceElement.html">bags/ActivitySequenceElement</a></div><div class="sidebar-section-children"><a href="module-bags_ActivitySequenceJump.html">bags/ActivitySequenceJump</a></div><div class="sidebar-section-children"><a href="module-bags_ConditionalJumpInfo.html">bags/ConditionalJumpInfo</a></div><div class="sidebar-section-children"><a href="module-bags_JumpInfo.html">bags/JumpInfo</a></div><div class="sidebar-section-children"><a href="module-bags_MediaBag.html">bags/MediaBag</a></div><div class="sidebar-section-children"><a href="module-bags_MediaBagElement.html">bags/MediaBagElement</a></div><div class="sidebar-section-children"><a href="module-boxes_AbstractBox.html">boxes/AbstractBox</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBagContent.html">boxes/ActiveBagContent</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBox.html">boxes/ActiveBox</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxBag.html">boxes/ActiveBoxBag</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxContent.html">boxes/ActiveBoxContent</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxGrid.html">boxes/ActiveBoxGrid</a></div><div class="sidebar-section-children"><a href="module-boxes_BoxBag.html">boxes/BoxBag</a></div><div class="sidebar-section-children"><a href="module-boxes_BoxBase.html">boxes/BoxBase</a></div><div class="sidebar-section-children"><a href="module-boxes_BoxConnector.html">boxes/BoxConnector</a></div><div class="sidebar-section-children"><a href="module-boxes_TextGrid.html">boxes/TextGrid</a></div><div class="sidebar-section-children"><a href="module-boxes_TextGridContent.html">boxes/TextGridContent</a></div><div class="sidebar-section-children"><a href="module-media_ActiveMediaBag.html">media/ActiveMediaBag</a></div><div class="sidebar-section-children"><a href="module-media_ActiveMediaPlayer.html">media/ActiveMediaPlayer</a></div><div class="sidebar-section-children"><a href="module-media_AudioBuffer.html">media/AudioBuffer</a></div><div class="sidebar-section-children"><a href="module-media_EventSounds.html">media/EventSounds</a></div><div class="sidebar-section-children"><a href="module-media_EventSoundsElement.html">media/EventSoundsElement</a></div><div class="sidebar-section-children"><a href="module-media_MediaContent.html">media/MediaContent</a></div><div class="sidebar-section-children"><a href="module-media_MidiAudioPlayer.html">media/MidiAudioPlayer</a></div><div class="sidebar-section-children"><a href="module-project_JClicProject.html">project/JClicProject</a></div><div class="sidebar-section-children"><a href="module-project_ProjectSettings.html">project/ProjectSettings</a></div><div class="sidebar-section-children"><a href="module-report_ActionReg.html">report/ActionReg</a></div><div class="sidebar-section-children"><a href="module-report_ActivityReg.html">report/ActivityReg</a></div><div class="sidebar-section-children"><a href="module-report_EncryptMin.html">report/EncryptMin</a></div><div class="sidebar-section-children"><a href="module-report_Reporter.html">report/Reporter</a></div><div class="sidebar-section-children"><a href="module-report_SCORM.html">report/SCORM</a></div><div class="sidebar-section-children"><a href="module-report_SequenceReg.html">report/SequenceReg</a></div><div class="sidebar-section-children"><a href="module-report_SessionReg.html">report/SessionReg</a></div><div class="sidebar-section-children"><a href="module-report_SessionStorageReporter.html">report/SessionStorageReporter</a></div><div class="sidebar-section-children"><a href="module-report_TCPReporter.html">report/TCPReporter</a></div><div class="sidebar-section-children"><a href="module-shapers_ClassicJigSaw.html">shapers/ClassicJigSaw</a></div><div class="sidebar-section-children"><a href="module-shapers_Holes.html">shapers/Holes</a></div><div class="sidebar-section-children"><a href="module-shapers_JigSaw.html">shapers/JigSaw</a></div><div class="sidebar-section-children"><a href="module-shapers_Rectangular.html">shapers/Rectangular</a></div><div class="sidebar-section-children"><a href="module-shapers_Shaper.html">shapers/Shaper</a></div><div class="sidebar-section-children"><a href="module-shapers_TriangularJigSaw.html">shapers/TriangularJigSaw</a></div><div class="sidebar-section-children"><a href="module-skins_BlueSkin.html">skins/BlueSkin</a></div><div class="sidebar-section-children"><a href="module-skins_Counter.html">skins/Counter</a></div><div class="sidebar-section-children"><a href="module-skins_CustomSkin.html">skins/CustomSkin</a></div><div class="sidebar-section-children"><a href="module-skins_DefaultSkin.html">skins/DefaultSkin</a></div><div class="sidebar-section-children"><a href="module-skins_EmptySkin.html">skins/EmptySkin</a></div><div class="sidebar-section-children"><a href="module-skins_GreenSkin.html">skins/GreenSkin</a></div><div class="sidebar-section-children"><a href="module-skins_MiniSkin.html">skins/MiniSkin</a></div><div class="sidebar-section-children"><a href="module-skins_OrangeSkin.html">skins/OrangeSkin</a></div><div class="sidebar-section-children"><a href="module-skins_SimpleSkin.html">skins/SimpleSkin</a></div><div class="sidebar-section-children"><a href="module-skins_Skin.html">skins/Skin</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="xnPDc3I_kKVhPtm1lO4E8"><div>Classes</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="module-AWT.Action.html">Action</a></div><div class="sidebar-section-children"><a href="module-AWT.Container.html">Container</a></div><div class="sidebar-section-children"><a href="module-AWT.Dimension.html">Dimension</a></div><div class="sidebar-section-children"><a href="module-AWT.Ellipse.html">Ellipse</a></div><div class="sidebar-section-children"><a href="module-AWT.Font.html">Font</a></div><div class="sidebar-section-children"><a href="module-AWT.Gradient.html">Gradient</a></div><div class="sidebar-section-children"><a href="module-AWT.Path.html">Path</a></div><div class="sidebar-section-children"><a href="module-AWT.PathStroke.html">PathStroke</a></div><div class="sidebar-section-children"><a href="module-AWT.Point.html">Point</a></div><div class="sidebar-section-children"><a href="module-AWT.Rectangle.html">Rectangle</a></div><div class="sidebar-section-children"><a href="module-AWT.Shape.html">Shape</a></div><div class="sidebar-section-children"><a href="module-AWT.Stroke.html">Stroke</a></div><div class="sidebar-section-children"><a href="module-AWT.Timer.html">Timer</a></div><div class="sidebar-section-children"><a href="module-Activity.Activity.html">Activity</a></div><div class="sidebar-section-children"><a href="module-Activity.ActivityPanel.html">ActivityPanel</a></div><div class="sidebar-section-children"><a href="module-JClicPlayer.JClicPlayer.html">JClicPlayer</a></div><div class="sidebar-section-children"><a href="module-PlayerHistory.PlayerHistory.html">PlayerHistory</a></div><div class="sidebar-section-children"><a href="module-activities_associations_ComplexAssociation.ComplexAssociation.html">ComplexAssociation</a></div><div class="sidebar-section-children"><a href="module-activities_associations_ComplexAssociation.ComplexAssociationPanel.html">ComplexAssociationPanel</a></div><div class="sidebar-section-children"><a href="module-activities_associations_SimpleAssociation.SimpleAssociation.html">SimpleAssociation</a></div><div class="sidebar-section-children"><a href="module-activities_associations_SimpleAssociation.SimpleAssociationPanel.html">SimpleAssociationPanel</a></div><div class="sidebar-section-children"><a href="module-activities_memory_MemoryGame.MemoryGame.html">MemoryGame</a></div><div class="sidebar-section-children"><a href="module-activities_memory_MemoryGame.MemoryGamePanel.html">MemoryGamePanel</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Explore.Explore.html">Explore</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Explore.ExplorePanel.html">ExplorePanel</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Identify.Identify.html">Identify</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Identify.IdentifyPanel.html">IdentifyPanel</a></div><div class="sidebar-section-children"><a href="module-activities_panels_InformationScreen.InformationScreen.html">InformationScreen</a></div><div class="sidebar-section-children"><a href="module-activities_panels_InformationScreen.InformationScreenPanel.html">InformationScreenPanel</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Menu.Menu.html">Menu</a></div><div class="sidebar-section-children"><a href="module-activities_panels_Menu.MenuPanel.html">MenuPanel</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_DoublePuzzle.DoublePuzzle.html">DoublePuzzle</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_DoublePuzzle.DoublePuzzlePanel.html">DoublePuzzlePanel</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_ExchangePuzzle.ExchangePuzzle.html">ExchangePuzzle</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_ExchangePuzzle-ExchangePuzzlePanel.html">ExchangePuzzlePanel</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_HolePuzzle.HolePuzzle.html">HolePuzzle</a></div><div class="sidebar-section-children"><a href="module-activities_puzzles_HolePuzzle.HolePuzzlePanel.html">HolePuzzlePanel</a></div><div class="sidebar-section-children"><a href="module-activities_text_Complete.Complete.html">Complete</a></div><div class="sidebar-section-children"><a href="module-activities_text_Complete.CompletePanel.html">CompletePanel</a></div><div class="sidebar-section-children"><a href="module-activities_text_Evaluator.BasicEvaluator.html">BasicEvaluator</a></div><div class="sidebar-section-children"><a href="module-activities_text_Evaluator.ComplexEvaluator.html">ComplexEvaluator</a></div><div class="sidebar-section-children"><a href="module-activities_text_Evaluator.Evaluator.html">Evaluator</a></div><div class="sidebar-section-children"><a href="module-activities_text_FillInBlanks.FillInBlanks.html">FillInBlanks</a></div><div class="sidebar-section-children"><a href="module-activities_text_FillInBlanks.FillInBlanksPanel.html">FillInBlanksPanel</a></div><div class="sidebar-section-children"><a href="module-activities_text_IdentifyText.IdentifyText.html">IdentifyText</a></div><div class="sidebar-section-children"><a href="module-activities_text_IdentifyText-IdentifyTextPanel.html">IdentifyTextPanel</a></div><div class="sidebar-section-children"><a href="module-activities_text_OrderText.OrderText.html">OrderText</a></div><div class="sidebar-section-children"><a href="module-activities_text_OrderText.OrderTextPanel.html">OrderTextPanel</a></div><div class="sidebar-section-children"><a href="module-activities_text_TextActivityBase.TextActivityBase.html">TextActivityBase</a></div><div class="sidebar-section-children"><a href="module-activities_text_TextActivityBase.TextActivityBasePanel.html">TextActivityBasePanel</a></div><div class="sidebar-section-children"><a href="module-activities_text_TextActivityDocument.TextActivityDocument.html">TextActivityDocument</a></div><div class="sidebar-section-children"><a href="module-activities_text_TextActivityDocument.TextTarget.html">TextTarget</a></div><div class="sidebar-section-children"><a href="module-activities_text_WrittenAnswer.WrittenAnswer.html">WrittenAnswer</a></div><div class="sidebar-section-children"><a href="module-activities_text_WrittenAnswer.WrittenAnswerPanel.html">WrittenAnswerPanel</a></div><div class="sidebar-section-children"><a href="module-activities_textGrid_CrossWord.CrossWord.html">CrossWord</a></div><div class="sidebar-section-children"><a href="module-activities_textGrid_CrossWord.CrossWordPanel.html">CrossWordPanel</a></div><div class="sidebar-section-children"><a href="module-activities_textGrid_WordSearch.WordSearch.html">WordSearch</a></div><div class="sidebar-section-children"><a href="module-activities_textGrid_WordSearch.WordSearchPanel.html">WordSearchPanel</a></div><div class="sidebar-section-children"><a href="module-automation_AutoContentProvider.AutoContentProvider.html">AutoContentProvider</a></div><div class="sidebar-section-children"><a href="module-automation_AutoContentProvider.AutoContentProvider.ActiveBagContentKit.html">ActiveBagContentKit</a></div><div class="sidebar-section-children"><a href="module-automation_arith_Arith.Arith.html">Arith</a></div><div class="sidebar-section-children"><a href="module-automation_arith_Arith.Arith.Operator.html">Operator</a></div><div class="sidebar-section-children"><a href="module-bags_ActivitySequence.ActivitySequence.html">ActivitySequence</a></div><div class="sidebar-section-children"><a href="module-bags_ActivitySequenceElement.ActivitySequenceElement.html">ActivitySequenceElement</a></div><div class="sidebar-section-children"><a href="module-bags_ActivitySequenceJump.ActivitySequenceJump.html">ActivitySequenceJump</a></div><div class="sidebar-section-children"><a href="module-bags_ConditionalJumpInfo.ConditionalJumpInfo.html">ConditionalJumpInfo</a></div><div class="sidebar-section-children"><a href="module-bags_JumpInfo.JumpInfo.html">JumpInfo</a></div><div class="sidebar-section-children"><a href="module-bags_MediaBag.MediaBag.html">MediaBag</a></div><div class="sidebar-section-children"><a href="module-bags_MediaBagElement.MediaBagElement.html">MediaBagElement</a></div><div class="sidebar-section-children"><a href="module-boxes_AbstractBox.AbstractBox.html">AbstractBox</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBagContent.ActiveBagContent.html">ActiveBagContent</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBox.ActiveBox.html">ActiveBox</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxBag.ActiveBoxBag.html">ActiveBoxBag</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxContent.ActiveBoxContent.html">ActiveBoxContent</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxContent.AlignType.html">AlignType</a></div><div class="sidebar-section-children"><a href="module-boxes_ActiveBoxGrid.ActiveBoxGrid.html">ActiveBoxGrid</a></div><div class="sidebar-section-children"><a href="module-boxes_BoxBag.BoxBag.html">BoxBag</a></div><div class="sidebar-section-children"><a href="module-boxes_BoxBase.BoxBase.html">BoxBase</a></div><div class="sidebar-section-children"><a href="module-boxes_BoxConnector.BoxConnector.html">BoxConnector</a></div><div class="sidebar-section-children"><a href="module-boxes_TextGrid.TextGrid.html">TextGrid</a></div><div class="sidebar-section-children"><a href="module-boxes_TextGridContent.TextGridContent.html">TextGridContent</a></div><div class="sidebar-section-children"><a href="module-media_ActiveMediaBag.ActiveMediaBag.html">ActiveMediaBag</a></div><div class="sidebar-section-children"><a href="module-media_ActiveMediaPlayer.ActiveMediaPlayer.html">ActiveMediaPlayer</a></div><div class="sidebar-section-children"><a href="module-media_AudioBuffer.AudioBuffer.html">AudioBuffer</a></div><div class="sidebar-section-children"><a href="module-media_EventSounds.EventSounds.html">EventSounds</a></div><div class="sidebar-section-children"><a href="module-media_EventSoundsElement.EventSoundsElement.html">EventSoundsElement</a></div><div class="sidebar-section-children"><a href="module-media_MediaContent.MediaContent.html">MediaContent</a></div><div class="sidebar-section-children"><a href="module-media_MidiAudioPlayer.MidiAudioPlayer.html">MidiAudioPlayer</a></div><div class="sidebar-section-children"><a href="module-project_JClicProject.JClicProject.html">JClicProject</a></div><div class="sidebar-section-children"><a href="module-project_ProjectSettings.ProjectSettings.html">ProjectSettings</a></div><div class="sidebar-section-children"><a href="module-report_ActionReg.ActionReg.html">ActionReg</a></div><div class="sidebar-section-children"><a href="module-report_ActivityReg.ActivityReg.html">ActivityReg</a></div><div class="sidebar-section-children"><a href="module-report_EncryptMin.Encryption.html">Encryption</a></div><div class="sidebar-section-children"><a href="module-report_Reporter.Reporter.html">Reporter</a></div><div class="sidebar-section-children"><a href="module-report_Reporter.ReporterInfo.html">ReporterInfo</a></div><div class="sidebar-section-children"><a href="module-report_SCORM.SCORM.html">SCORM</a></div><div class="sidebar-section-children"><a href="module-report_SequenceReg.SequenceReg.html">SequenceReg</a></div><div class="sidebar-section-children"><a href="module-report_SequenceReg.SequenceRegInfo.html">SequenceRegInfo</a></div><div class="sidebar-section-children"><a href="module-report_SessionReg.SessionReg.html">SessionReg</a></div><div class="sidebar-section-children"><a href="module-report_SessionReg.SessionRegInfo.html">SessionRegInfo</a></div><div class="sidebar-section-children"><a href="module-report_SessionStorageReporter.SessionStorageReporter.html">SessionStorageReporter</a></div><div class="sidebar-section-children"><a href="module-report_TCPReporter.ReportBean.html">ReportBean</a></div><div class="sidebar-section-children"><a href="module-report_TCPReporter.TCPReporter.html">TCPReporter</a></div><div class="sidebar-section-children"><a href="module-shapers_ClassicJigSaw.ClassicJigSaw.html">ClassicJigSaw</a></div><div class="sidebar-section-children"><a href="module-shapers_Holes.Holes.html">Holes</a></div><div class="sidebar-section-children"><a href="module-shapers_JigSaw.JigSaw.html">JigSaw</a></div><div class="sidebar-section-children"><a href="module-shapers_Rectangular.Rectangular.html">Rectangular</a></div><div class="sidebar-section-children"><a href="module-shapers_Shaper.Shaper.html">Shaper</a></div><div class="sidebar-section-children"><a href="module-shapers_TriangularJigSaw.TriangularJigSaw.html">TriangularJigSaw</a></div><div class="sidebar-section-children"><a href="module-skins_BlueSkin.BlueSkin.html">BlueSkin</a></div><div class="sidebar-section-children"><a href="module-skins_Counter.Counter.html">Counter</a></div><div class="sidebar-section-children"><a href="module-skins_CustomSkin.CustomSkin.html">CustomSkin</a></div><div class="sidebar-section-children"><a href="module-skins_DefaultSkin.DefaultSkin.html">DefaultSkin</a></div><div class="sidebar-section-children"><a href="module-skins_EmptySkin.EmptySkin.html">EmptySkin</a></div><div class="sidebar-section-children"><a href="module-skins_GreenSkin.GreenSkin.html">GreenSkin</a></div><div class="sidebar-section-children"><a href="module-skins_MiniSkin.MiniSkin.html">MiniSkin</a></div><div class="sidebar-section-children"><a href="module-skins_OrangeSkin.OrangeSkin.html">OrangeSkin</a></div><div class="sidebar-section-children"><a href="module-skins_SimpleSkin.SimpleSkin.html">SimpleSkin</a></div><div class="sidebar-section-children"><a href="module-skins_Skin.Skin.html">Skin</a></div></div><div class="sidebar-section-title with-arrow" data-isopen="false" id="xJuSofp4IKU_YxKjABy4G"><div>Externals</div><svg><use xlink:href="#down-icon"></use></svg></div><div class="sidebar-section-children-container"><div class="sidebar-section-children"><a href="external-AudioContext.html">AudioContext</a></div><div class="sidebar-section-children"><a href="external-CanvasRenderingContext2D.html">CanvasRenderingContext2D</a></div><div class="sidebar-section-children"><a href="external-Collator.html">Collator</a></div><div class="sidebar-section-children"><a href="external-Date.html">Date</a></div><div class="sidebar-section-children"><a href="external-Event.html">Event</a></div><div class="sidebar-section-children"><a href="external-HTMLAudioElement.html">HTMLAudioElement</a></div><div class="sidebar-section-children"><a href="external-HTMLElement.html">HTMLElement</a></div><div class="sidebar-section-children"><a href="external-HTMLImageElement.html">HTMLImageElement</a></div><div class="sidebar-section-children"><a href="external-HTMLStyleElement.html">HTMLStyleElement</a></div><div class="sidebar-section-children"><a href="external-Instrument.html">Instrument</a></div><div class="sidebar-section-children"><a href="external-JSZip.html">JSZip</a></div><div class="sidebar-section-children"><a href="external-MediaRecorder.html">MediaRecorder</a></div><div class="sidebar-section-children"><a href="external-MidiPlayerJS.html">MidiPlayerJS</a></div><div class="sidebar-section-children"><a href="external-NamedNodeMap.html">NamedNodeMap</a></div><div class="sidebar-section-children"><a href="external-Promise.html">Promise</a></div><div class="sidebar-section-children"><a href="external-Storage.html">Storage</a></div><div class="sidebar-section-children"><a href="external-jQuery.html">jQuery</a></div><div class="sidebar-section-children"><a href="external-jqXHR.html">jqXHR</a></div></div></div><div class="mobile-navbar-actions"><div class="navbar-right-item"><button class="icon-button search-button" aria-label="open-search"><svg><use xlink:href="#search-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button theme-toggle" aria-label="toggle-theme"><svg><use class="theme-svg-use" xlink:href="#light-theme-icon"></use></svg></button></div><div class="navbar-right-item"><button class="icon-button font-size" aria-label="change-font-size"><svg><use xlink:href="#font-size-icon"></use></svg></button></div></div></div></div><script type="text/javascript" src="scripts/core.min.js"></script><script src="scripts/search.min.js" defer="defer"></script><script src="scripts/third-party/fuse.js" defer="defer"></script><script type="text/javascript">var tocbotInstance=tocbot.init({tocSelector:"#eed4d2a0bfd64539bb9df78095dec881",contentSelector:".main-content",headingSelector:"h1, h2, h3",hasInnerContainers:!0,scrollContainer:".main-content",headingsOffset:130,onClick:bringLinkToView})</script></body></html>